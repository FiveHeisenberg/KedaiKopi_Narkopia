<!DOCTYPE html>
<html>
<head>
    <title>Pembayaran Berhasil!</title>

    <!-- CSS -->
    <link rel="stylesheet" href="css/payment_success.css">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Courier+Prime:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel="stylesheet">

    <!-- Icon Web -->
    <link rel="icon" type="image/x-icon" href="img/logo/logo.png">
    
    <!-- ICON -->
    <link href='https://unpkg.com/boxicons@2.0.9/css/boxicons.min.css' rel='stylesheet'>
<body>
    <div class="container">
        <!-- Logo -->
        <div class="logo">
            <h3>Nar<span>kopia</span></h3>
        </div>
        <hr>
        <!-- Header -->
        <div class="receipt">
            <h1>Pembayaran Berhasil</h1>
            <h2>Struk Pembayaran</h2>

            <!-- Content Struck -->
            <div class="details">
                <p><strong>Nama</strong>:<span id="customerName"></span></p>
                <p><strong>Nomor Telepon</strong>:<span id="customerPhone"></span></p>
                <p><strong>Metode Pengambilan</strong>:<span id="pickupMethod"></span></p>
                <p><strong>Tanggal</strong>:<span id="paymentDate"></span></p>
                <p><strong>Jam</strong>:<span id="paymentTime"></span></p>
                <p><strong>Total Item</strong>:<span id="totalItems"></span></p>
                <p><strong>Total Harga</strong>:<span id="totalPrice"></span></p>         
            </div>
            <hr>
            <div class="ket">
                <p>Terima Kasih dan Selamat Menikmati!</p>
            </div>

            <!-- Tombol cetak struk dan kembali ke menu -->
            <div class="button" id="button">
                <button onclick="handlePrintClick()">Cetak Struk</button>
                <a href="#" class="backButton" id="backToMenu">Kembali ke Menu</a>
            </div>

        </div>
    </div>

    <!-- Pop Up untuk rating -->
    <div id="ratingModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>Beri Rating Kami</h2>
            <div class="rating">
                <i class='bx bxs-star' data-value="1"></i>
                <i class='bx bxs-star' data-value="2"></i>
                <i class='bx bxs-star' data-value="3"></i>
                <i class='bx bxs-star' data-value="4"></i>
                <i class='bx bxs-star' data-value="5"></i>
            </div>
            <button id="submitRating">Submit</button>
        </div>
    </div>

    <!-- Modal untuk ucapan terima kasih -->
    <div id="thankYouModal" class="modal">
        <div class="modal-content">
            <span class="close" id="closeThankYou">&times;</span>
            <h2>Terima Kasih!</h2>
            <p>Terima kasih atas rating Anda!</p>
            <button id="goToMenu">Kembali ke Menu</button>
        </div>
    </div>

    <script>
        function handlePrintClick() {
            document.getElementById("button").style.display = "none";
            window.print();
        }

        window.addEventListener("afterprint", function() {
            document.getElementById("button").style.display = "block";
        });

        document.getElementById('backToMenu').addEventListener('click', function(event) {
            event.preventDefault(); // Prevent the default action
            document.getElementById('ratingModal').style.display = 'block'; // Show the modal
        });

        const stars = document.querySelectorAll('.rating i');
        let selectedRating = 0;

        stars.forEach(star => {
            star.addEventListener('click', function() {
                selectedRating = this.getAttribute('data-value');
                updateStars(selectedRating);
            });

            star.addEventListener('mouseover', function() {
                updateStars(this.getAttribute('data-value'));
            });

            star.addEventListener('mouseout', function() {
                updateStars(selectedRating);
            });
        });

        function updateStars(rating) {
            stars.forEach(star => {
                if (star.getAttribute('data-value') <= rating) {
                    star.classList.add('selected');
                    star.classList.remove('hovered');
                } else {
                    star.classList.remove('selected');
                    star.classList.remove('hovered');
                }
            });
        }

        document.getElementById('submitRating').addEventListener('click', function() {
            if (selectedRating > 0) {
                console.log('Rating submitted:', selectedRating);
                // TODO: Send rating to the server or handle it accordingly
                document.getElementById('ratingModal').style.display = 'none'; // Hide the rating modal
                document.getElementById('thankYouModal').style.display = 'block'; // Show the thank you modal
            } else {
                alert('Please select a rating before submitting.');
            }
        });

        document.getElementById('closeThankYou').addEventListener('click', function() {
            document.getElementById('thankYouModal').style.display = 'none'; // Hide the modal
            deleteCookie('listCart'); // Delete the cookie
            window.location.href = 'menu.html'; // Redirect to the menu page
        });

        document.getElementById('goToMenu').addEventListener('click', function() {
            document.getElementById('thankYouModal').style.display = 'none'; // Hide the modal
            deleteCookie('listCart'); // Delete the cookie
            window.location.href = 'menu.html'; // Redirect to the menu page
        });

        document.querySelector('.close').addEventListener('click', function() {
            document.getElementById('ratingModal').style.display = 'none'; // Hide the modal
        });

        window.onclick = function(event) {
            if (event.target == document.getElementById('ratingModal')) {
                document.getElementById('ratingModal').style.display = 'none'; // Hide the modal
            }
        };

        function deleteCookie(name) {
            document.cookie = name + '=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;';
        }
    </script>
    <script src="js/payment_success.js"></script>
</body>
</html>
